---
layout: post
title: "Retrieving list of installed applications"
date: 2008-05-07
comments: true
tags: [  HowTo, Windows OS ]
---

From now and then it happens that you have to reset your workstation, meaning to reformat your hard disk and install everything fresh. In this way you get rid of all the garbage on your PC. In such a case it may be useful afterwards to have a list of all of the previously installed applications in order to have your loved, every-day used programs :) installed and configured. Opening the "Add or remove programs" entry of the control panel for copying (by hand) all of the entries is for sure not the best approach for that. Usually as software developer you are too lazy to do such things manually and you try to automate things as much as possible (also if sometimes at the end it costs you more time ;) ).<br />Actually there is an automated solution for this problem here (otherwise of course I wouldn't probably write this post here). I have two different versions. The first, which is the simpler one, queries the Windows registry, while the second queries directly the <a href="http://en.wikipedia.org/wiki/Windows_Management_Instrumentation">WMI service</a>. You can simply start the script and wait till the "Done" message box appears. The <span style="font-style: italic;">softwareSimple.vbs</span> and the <span style="font-style: italic;">softwareExtended.vbs</span> create a <span style="font-style: italic;">software_simple.csv</span> and a <span style="font-style: italic;">software_ext.tsv</span> correspondingly. The best way to view them is to open them with MS Excel or another spreadsheet application.<br /><br /><span style="font-weight: bold;font-size:130%;" >SoftwareSimple.vbs</span><br /><pre class="prettyprint">strHost = "."<br />Const HKLM = &amp;H80000002<br />Set objFSO = CreateObject("Scripting.FileSystemObject")<br />Set objTextFile = objFSO.CreateTextFile("software_simple.csv", True)<br />objTextFile.WriteLine "Program Name" &amp; ";" &amp; "Installation date"<br />Set objReg = GetObject("winmgmts://" &amp; strHost &amp; "/root/default:StdRegProv")<br />Const strBaseKey = "Software\Microsoft\Windows\CurrentVersion\Uninstall\"<br />objReg.EnumKey HKLM, strBaseKey, arrSubKeys<br />For Each strSubKey In arrSubKeys<br />   intRet = objReg.GetStringValue(HKLM, strBaseKey &amp; strSubKey, "DisplayName", strValue)<br />   If intRet &lt;&gt; 0 Then<br />       intRet = objReg.GetStringValue(HKLM, strBaseKey &amp; strSubKey,        "QuietDisplayName", strValue)<br />   End If<br />   intRet1 = objReg.GetStringValue(HKLM, strBaseKey &amp; strSubKey, "InstallDate", strValue2)<br />   If (strValue &lt;&gt; "") and (intRet = 0) Then<br />       objTextFile.WriteLine strValue &amp; ";" &amp; strValue2<br />   End If<br />Next<br />WScript.Echo "Done"<br />objTextFile.Close</pre><br /><br /><span style="font-size:130%;"><span style="font-weight: bold;">SoftwareExtended.vbs</span></span><br /><pre class="prettyprint">Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)<br />Set objTextFile = objFSO.CreateTextFile(&quot;software_ext.tsv&quot;, True)<br />strComputer = &quot;.&quot;<br />Set objWMIService = GetObject(&quot;winmgmts:&quot; _<br /> & &quot;{impersonationLevel=impersonate}!\\&quot; & strComputer & &quot;\root\cimv2&quot;)<br />Set colSoftware = objWMIService.ExecQuery (&quot;SELECT * FROM Win32_Product&quot;)<br />objTextFile.WriteLine &quot;Caption&quot; & vbtab & _<br />&quot;Description&quot; & vbtab & &quot;Identifying Number&quot; & vbtab & _<br />&quot;Install Date&quot; & vbtab & &quot;Install Location&quot; & vbtab & _<br />&quot;Install State&quot; & vbtab & &quot;Name&quot; & vbtab & _<br />&quot;Package Cache&quot; & vbtab & &quot;SKU Number&quot; & vbtab & &quot;Vendor&quot; & vbtab _<br /> & &quot;Version&quot;<br />For Each objSoftware in colSoftware<br /> objTextFile.WriteLine objSoftware.Caption & vbtab & _<br /> objSoftware.Description & vbtab & _<br /> objSoftware.IdentifyingNumber & vbtab & _<br /> objSoftware.InstallDate & vbtab & _<br /> objSoftware.InstallLocation & vbtab & _<br /> objSoftware.InstallState & vbtab & _<br /> objSoftware.Name & vbtab & _<br /> objSoftware.PackageCache & vbtab & _<br /> objSoftware.SKUNumber & vbtab & _<br /> objSoftware.Vendor & vbtab & _<br /> objSoftware.Version<br />Next<br />WScript.Echo &quot;Done&quot;<br />objTextFile.Close</pre><br /><br />You can also download them from here:<br /><span style="font-size:130%;"><a href="http://strumpflohner.blog.googlepages.com/softwarevbscripts.zip">softwarevbscripts.zip</a></span>