---
layout: post
title: "HowTo: Create 'linked tables' in MS Access"
date: 2008-10-02
comments: true
tags: [  HowTo, VBA ]
---

Assume you have to migrate some historical data from an application which used an MS Access database to a new application which uses some other DB system (in my case an Oracle DB). Well, if the underlying schema of both DBs is the same, it won't be a big deal, but if they differ from each other, it might become more complicated. In such a situation the best way is probably to create different queries in the MS Access DB which preprare your data s.t. it matches the structure of the Oracle DB schema. Once you've done that you can create so-called "linked tables" inside MS Access and then insert the data of your queries into these linked tables (can be done with an "append query").<br /><br /><span style="font-weight: bold;">How to create a "linked table" to an existing Oracle DB schema</span><br /><ol><li>Right-click on the Navigation panel<br /><a href="http://3.bp.blogspot.com/_tF6XjsUy87k/SOIi_AVquZI/AAAAAAAABiI/DVDDsQyypZU/s1600-h/linkingTables1.jpg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_tF6XjsUy87k/SOIi_AVquZI/AAAAAAAABiI/uuOzs-Z80JM/s320-R/linkingTables1.jpg" /></a><br /><br /></li><li>Choose "Link to the data source by creating a linked table"<br /><a href="http://4.bp.blogspot.com/_tF6XjsUy87k/SOIjwScyXtI/AAAAAAAABiQ/XgZGuOsLq0k/s1600-h/linkingTables2.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_tF6XjsUy87k/SOIjwScyXtI/AAAAAAAABiQ/xE2s6cwVCsk/s320-R/linkingTables2.jpg" /></a><br /><br /></li><li>Go to the tab "Machine Data Source" and choose "New..."<br /><a href="http://4.bp.blogspot.com/_tF6XjsUy87k/SOImExfELRI/AAAAAAAABiY/yKSMP8bT9tQ/s1600-h/linkingTables3.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_tF6XjsUy87k/SOImExfELRI/AAAAAAAABiY/EWWfBbKDajc/s320-R/linkingTables3.jpg" /></a><br /><br /></li><li>Choose the right driver<br /><a href="http://4.bp.blogspot.com/_tF6XjsUy87k/SOIuFi7x9-I/AAAAAAAABig/7xxSomvoROk/s1600-h/linkingTables4.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_tF6XjsUy87k/SOIuFi7x9-I/AAAAAAAABig/-zY8i6EA6L8/s320-R/linkingTables4.jpg" /></a><br /><br /></li><li>Finally, provide the necessary access credentials<br /><a href="http://4.bp.blogspot.com/_tF6XjsUy87k/SOIuVIiDBWI/AAAAAAAABio/slUhYMhqmYo/s1600-h/linkingTables5.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_tF6XjsUy87k/SOIuVIiDBWI/AAAAAAAABio/Nxk_p2fiHgM/s320-R/linkingTables5.jpg" /></a><br /><br /></li><li>The linked tables will have a special icon<br /><a href="http://1.bp.blogspot.com/_tF6XjsUy87k/SOI7-an_c8I/AAAAAAAABiw/5nZL3d-Bmbc/s1600-h/linkedTableIcon.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/_tF6XjsUy87k/SOI7-an_c8I/AAAAAAAABiw/wlh1aIR2bKE/s320-R/linkedTableIcon.jpg" /></a><br /></li></ol><div>Once you completed these steps, you can execute your queries (inserts, deletes, updates) against the linked tables. The changes will then be automatically reflected on your linked DB.<br />What you should do - especially if you know that you have to do the import multiple times with actualized data - is to automate the whole process. This can be easily achieved with a bit of VBA code as the following</div><br /><pre class="prettyprint">Private Function executeQuery(ByVal queryName As String) As Boolean<br />    On Error GoTo err<br /><br />    Dim dbs As Database<br /><br />    Set dbs = CurrentDb<br /><br />    If (queryName &lt;&gt; "") Then<br />        Debug.Print "Execute query " &amp; queryName<br />        dbs.Execute (queryName)<br />    End If<br /><br />    executeQuery = True<br />    GoTo final<br /><br />err:<br />    executeQuery = False<br />    errorMsg = err.Description<br /><br />final:<br />    Set dbs = Nothing<br />End Function</pre><br />This code allows you to execute a query you've created on your MS Access DB. The rest should be obvious and if you want to make it more user-friendly your outcome may look similar to the following:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_tF6XjsUy87k/SON4yzUdmeI/AAAAAAAABi4/zrxukihF8IU/s1600-h/dbImport2.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/_tF6XjsUy87k/SON4yzUdmeI/AAAAAAAABi4/BDHCkF5nXTM/s320-R/dbImport2.jpg" /></a></div><div style="text-align: left;"></div>