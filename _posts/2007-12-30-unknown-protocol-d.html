---
layout: post
title: "Unknown protocol: d"
date: 2007-12-30
comments: true
tags: [  Java ]
---

Today morning when starting a general build of the project I'm currently working on, I got an error saying "unknown protocol: d". It was strange since I couldn't remember of any big changes made and the build didn't also fail the last time. But that's how programming is sometimes. Anyway, "d" was indicating that something must have gone wrong when accessing the hard-disk drive "D". The stack-trace gave me the following:<br /><pre class="prettyprint"><br />Exception in thread "main" java.net.MalformedURLException: unknown protocol: d<br />at java.net.URL.<init>(Unknown Source)<br />at java.net.URL.<init>(Unknown Source)<br />at java.net.URL.<init>(Unknown Source)<br />at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntity(Unknown Source)<br />at com.sun.org.apache.xerces.internal.impl.XMLVersionDetector.determineDocVersion(Unknown Source)<br />at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)<br />at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)<br />at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown Source)<br />at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown Source)<br />at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)<br />at org.jdom.input.SAXBuilder.build(SAXBuilder.java:453)<br />at org.jdom.input.SAXBuilder.build(SAXBuilder.java:891)<br />at org.devbook.utils.<b>XMLHandler.buildDOM</b>(XMLHandler.java:50)<br />at org.devbook.utils.XMLHandler.loadXMLFile(XMLHandler.java:37)<br />at org.devbook.data.XMLPersistencyAdapter.load(XMLPersistencyAdapter.java:159)<br />at org.devbook.sandbox.TestClass.main(TestClass.java:22)<br /></init></init></init></pre>It turned out that the SAXBuilder of JDom caused the error:<br /><pre class="prettyprint">private void buildDOM() throws JDOMException, IOException{<br />SAXBuilder builder = new SAXBuilder();<br />try {<br />   <b>doc = builder.build(xmlPath);</b><br />} catch (JDOMException e) {<br />   throw e;<br />} catch (IOException e) {<br />   throw e;<br />}<br />}<br /></pre>It seems as if the String "xmlPath" which is in the form "D:\\Folder1\\...\\file.xml" is not correctly interpreted as a file reference. Normally such path references are converted internally into the correct file / URL references. If this is not the case - as in my example here - one has to do it by either explicitly creating a valid URL, appending "file:///" such that it looks as follows<br /><pre class="prettyprint"><br />doc = builder.build(new URL("file:///" + xmlPath));<br /></pre><br />or to directly create a file reference. I preferred that solution:<br /><pre class="prettyprint">private void buildDOM() throws JDOMException, IOException{<br />SAXBuilder builder = new SAXBuilder();<br />try {<br />   <b>doc = builder.build(new File(xmlPath));</b><br />} catch (JDOMException e) {<br />   throw e;<br />} catch (IOException e) {<br />   throw e;<br />}<br />}</pre>Attention: Just appending the protocol type "file:///" to the String "xmlPath" isn't enough. It wouldn't show any error but it would not load the xml file correctly (at it least that was my situation). To make it work correctly, one has to explicitly create an object of type java.net.URL (as shown above).