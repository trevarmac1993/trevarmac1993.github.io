---
layout: post
title: "Android SMS activity doesn't fill phone number"
date: 2009-12-26
comments: true
tags: [  annotated, Java, mobile dev, Android ]
---

<p>Today while fixing a bug for our current project we develop for the Android phone I found a strange behavior when trying to launch the phone's SMS sender activity. For those of you non-Android-devs, Android has the concept of <a href="http://developer.android.com/reference/android/content/Intent.html">Intents</a>.<br /><blockquote>An intent is an abstract description of an operation to be performed. [...]<br /><span style="font-size: small;"><i><a href="http://developer.android.com/reference/android/content/Intent.html">(from the Android docs)</a></i></span></p>

</blockquote>This is a really nice mechanism. Basically you launch an Intent, specifying what you'd like to do and those activities out there which may be able to respond to your needs will answer. (a bit simplified of course ;) )<br /><br />So in our code we launched the phones SMS sender activity by specifying the intent as<br /><pre class="prettyprint">Intent smsIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("tel:3330349"));<br />smsIntent.setType("vnd.android-dir/mms-sms");<br /><br />startActivity(smsIntent);</pre>The problem as you can see:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_tF6XjsUy87k/SzYaUwZxvWI/AAAAAAAACfY/yucSGmg0URY/s1600-h/sms_notworking.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://2.bp.blogspot.com/_tF6XjsUy87k/SzYaUwZxvWI/AAAAAAAACfY/yucSGmg0URY/s320/sms_notworking.png" width="218" /></a><br /></div>...the phone number that has been passed in the intent-uri is not displayed on the SMS activity as it should. I searched a bit around and well...there shouldn't be "tel:...." in the Uri but rather "smsto:...". Fair enough, although by specifying the type of the intent I'd expect to get it anyway. So what I did is to change the intent Uri to..<br /><pre class="prettyprint">Intent smsIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("smsto:3330349"));<br />smsIntent.setType("vnd.android-dir/mms-sms");<br /><br />startActivity(smsIntent);</pre>..expecting to get it to work now: nothing. Still the same result, the activity opens but there's no phone number displayed. So...?! *confused*<br />Well, I found that you basically have the following possibilities.<br /><ol><li>Just specify the Uri. Ok, it's enough, you have all of the needed information encoded in it, but again, additionally specifying the intent type shouldn't be a problem.<br /><pre class="prettyprint">Intent smsIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("smsto:3330349"));<br />//smsIntent.setType("vnd.android-dir/mms-sms");<br /><br />startActivity(smsIntent);</pre></li><li>Specify the phone number by adding it to the intent bundle data.<br /><pre class="prettyprint">Intent smsIntent = new Intent(Intent.ACTION_VIEW);<br />smsIntent.putExtra("address", "3330349");<br />smsIntent.setType("vnd.android-dir/mms-sms");<br /><br />startActivity(smsIntent);</pre></li></ol>Both will bring you the expected result<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_tF6XjsUy87k/SzYgdgLF5pI/AAAAAAAACfc/cAv2qiOv_ls/s1600-h/sms_working.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://3.bp.blogspot.com/_tF6XjsUy87k/SzYgdgLF5pI/AAAAAAAACfc/cAv2qiOv_ls/s320/sms_working.png" width="218" /></a><br /></div><br />I understand, specifying the uri containing the "smsto" <b>and</b>&nbsp;the type is somehow redundant information, but anyway I wouldn't expect that it doesn't work at all.