---
layout: post
title: "ASP.net: Organize Your Resources the Correct Way!"
date: 2011-01-18
comments: true
tags: [  ASP.net, Best Practices, C#, Web dev ]
---

ASP.net provides well-known mechanisms for localizing web applications, namely by extracting hard-coded strings into resources files. Localization for Pages and UserControls is fully automated and available from within Visual Studio. While most of these issues may seem quite obvious to you, I think it is still worth mentioning some organizational facts related on how to distribute local vs. global resources. I always again encounter devs using the same resource messages repeated over and over again distributed onto many local, page-related resource files. This makes it an extremely annoying process if you happen to encounter the need for changing them.<br /><br /><span class="Apple-style-span" style="font-size: large;"><b>"App_LocalResources" vs. "App_GlobalResources" folder</b></span><br />Mainly there are two different types of resources, those available locally to the target element that has been localized (i.e. for the ASP.net Page or UserControl) and those that are globally available to the whole application.<br /><br />Local resources are being generated by opening the design view of a Page or UserControl and by then clicking on the Visual Studio menu "Tools &gt; Generate Local Resource". This automatically generates appropriate resource files in the "App_LocalResources" folder.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_tF6XjsUy87k/TTVVkT3vEbI/AAAAAAAACys/RIKRTtKjvX0/s1600/AppLocalResources.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_tF6XjsUy87k/TTVVkT3vEbI/AAAAAAAACys/RIKRTtKjvX0/s1600/AppLocalResources.jpg" /></a></div>Moreover it adds "meta:resourcekey" tags to the localized server controls on the ASPX code:<br /><pre class="brush:xml"><siag:siaglabel id="lblUsername" meta:resourcekey="lblUsernameResource1" runat="server" text="Username:"></siag:siaglabel>  <br /></pre>All of the generated resources within the App_LocalResources file are just locally available to each Page/UserControl they belong to.<br /><br />On the other side, App_GlobalResources are - as the name already suggests - globally available to the whole application. They are normally not generated automatically, but created on demand. If the App_GlobalResources folder doesn't yet exist, it can be created by right-clicking on the project in the Visual Studio Solution Explorer and by then choosing the appropriate menu entry (as shown in the following figure)<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_tF6XjsUy87k/TTVWGX0g0AI/AAAAAAAACyw/kZcp3yDWNPw/s1600/CreatingAppGlobalResourcesFolder.png" imageanchor="1" rel="zoombox" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="255" src="http://2.bp.blogspot.com/_tF6XjsUy87k/TTVWGX0g0AI/AAAAAAAACyw/kZcp3yDWNPw/s320/CreatingAppGlobalResourcesFolder.png" width="320" /></a></div><br /><span class="Apple-style-span" style="font-size: large;"><b>Which resources are good candidates to become global?</b></span><br />Resources that are good candidates to become global and should therefore be placed in the App_GlobalResources folder are all those which may appear to be replicated throughout the application and are not specific to a certain Page or UserControl.<br /><br />Examples are:<br /><ul><li>Common action names such as "Save", "Delete", "Back",...</li><li>Common, generic messages such as "Successfully saved", ...</li></ul><span class="Apple-style-span" style="font-size: large;"><b>Which resources are good candidates to go into the App_LocalResources folder?</b></span><br />Simply all of the resources that only belong to the Page or UserControl itself and are not shared among different entities.<br /><br /><span class="Apple-style-span" style="font-size: large;"><b>How to access resources in the ASPX code?</b></span><br /><b>Local Resources</b><br />Local resources can be accessed in the ASPX code either by specifying a meta:resourcekey tag (which is also automatically done by generating them through VS) or as follows:<br /><pre class="brush:xml">&lt;%= GetLocalResourceObject("resourcekey") %&gt;<br /></pre><br /><b>Global Resources</b><br />Global resources can be accessed by using the following syntax<br /><pre class="brush:xml">&lt;%$ Resources:GlobalResourceFilename, MY_KEY_IN_THE_RESOURCE_FILE %&gt;  <br /></pre><br /><span class="Apple-style-span" style="font-size: large;"><b>How to access resources in the C# code?</b></span><br /><b>Local Resources</b><br /><pre class="brush:c#">GetLocalResourceObject("resourcekey")  <br /></pre><br /><b>Global Resources</b><br /><pre class="brush:c#">GetGlobalResourceObject("GlobalResourceFilename", "resourceKey");  <br /></pre>